<!-- 定义部分 -->
<Window x:Class="SodiumPaint.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="SodiumPaint"
        Height="900" Width="1250"
        Top=" 100" Left="100"
        SizeToContent="Manual"
        MouseWheel="OnMouseWheelZoom">






    <DockPanel LastChildFill="True">
        <!-- 顶部菜单栏 -->

        <Menu DockPanel.Dock="Top">
            <MenuItem Header="文件">
                <MenuItem Header="新建" Click="OnNewClick" InputGestureText="Ctrl+N"/>
                <MenuItem Header="打开" Click="OnOpenClick" InputGestureText="Ctrl+O"/>
                <Separator/>
                <MenuItem Header="保存" Click="OnSaveClick" InputGestureText="Ctrl+S"/>
                <MenuItem Header="另存为..." Click="OnSaveAsClick"/>
            </MenuItem>
        </Menu>


        <!-- 工具栏 -->
        <ToolBar DockPanel.Dock="Top">
            <Button Content="打开图片" Click="OnOpenClick"/>
            <Button Content="铅笔" Click="OnPenClick"/>
            <Button Content="取颜色" Click="OnPickColorClick"/>
            <Button Content="橡皮擦" Click="OnEraserClick"/>
            <Button Content="选择" Click="OnSelectClick"/>
            <Button Content="撤销" Click="OnUndoClick"/>
            <Button Content="重做" Click="OnRedoClick"/>

            <Separator/>
            <Label Content="颜色:"/>

            <!-- 颜色按钮列表 -->
            <ItemsControl ItemsSource="{Binding ColorItems}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Button Width="20" Height="20"
                    Margin="1"
                    Click="OnColorButtonClick"
                    Background="{Binding}">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Ellipse Fill="{TemplateBinding Background}"
                                 Stroke="Gray" StrokeThickness="1"/>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- 自定义颜色按钮 -->
            <Button Width="20" Height="20" Margin="1"
        ToolTip="自定义颜色"
        Click="OnCustomColorClick">
                <Ellipse>
                    <Ellipse.Fill>
                        <RadialGradientBrush>
                            <GradientStop Color="Red" Offset="0.0"/>
                            <GradientStop Color="Orange" Offset="0.25"/>
                            <GradientStop Color="Yellow" Offset="0.5"/>
                            <GradientStop Color="Green" Offset="0.75"/>
                            <GradientStop Color="Blue" Offset="1.0"/>
                        </RadialGradientBrush>
                    </Ellipse.Fill>
                </Ellipse>
            </Button>
        </ToolBar>


        <!-- 顶部文件栏 待添加 -->

        <!-- 底部状态栏 -->
        <StatusBar DockPanel.Dock="Bottom">

            <!-- 当前鼠标位置 -->
            <StatusBarItem Content="{Binding MousePosition}" Width="150"/>

            <!-- 图片尺寸 -->
            <StatusBarItem Content="{Binding ImageSize}" Width="100"/>

            <!-- 框选区域大小 -->
            <StatusBarItem Content="{Binding SelectionSize}" Width="120"/>

            <Separator/>

            <StatusBarItem Content="{Binding ZoomLevel}" Width="80"/>

            <StatusBarItem>
                <Slider Name="ZoomSlider" Minimum="0.1" Maximum="8.0"
                Value="{Binding ZoomScale, Mode=TwoWay}"
                Width="120" TickFrequency="0.1" SmallChange="0.1"
                IsSnapToTickEnabled="True"/>
            </StatusBarItem>
        </StatusBar>



        <!-- 可缩放滚动区域 -->
        <ScrollViewer Name="ScrollContainer"
              HorizontalScrollBarVisibility="Auto"
              VerticalScrollBarVisibility="Auto"
              PreviewMouseWheel="OnMouseWheelZoom"
                      Background="#f0f0f0">




            <Grid Name="CanvasWrapper"
      HorizontalAlignment="Center"
      VerticalAlignment="Center"
      SnapsToDevicePixels="True"
      UseLayoutRounding="True"
    >

                <Grid.LayoutTransform>
                    <ScaleTransform x:Name="ZoomTransform" ScaleX="1" ScaleY="1" />
                </Grid.LayoutTransform>

                <!-- 背景图片 -->
                <Image Name="BackgroundImage"
           Stretch="None"
           HorizontalAlignment="Left"
           VerticalAlignment="Top"
           SnapsToDevicePixels="True"
           RenderOptions.BitmapScalingMode="NearestNeighbor" />

                <!-- 选区预览层 -->
                <Image Name="SelectionPreview"
           Stretch="None"
           HorizontalAlignment="Left"
           VerticalAlignment="Top"
           IsHitTestVisible="False"
           RenderOptions.BitmapScalingMode="NearestNeighbor"
           Visibility="Collapsed" />

                <!-- 选区边框 & 句柄层 -->
                <Canvas Name="SelectionOverlayCanvas"
            Visibility="Collapsed"
            IsHitTestVisible="False"
            Background="Transparent">
                </Canvas>
            </Grid>



        </ScrollViewer>
    
    </DockPanel>
</Window>